<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../../jacoco-resources/report.gif" type="image/gif"/><title>CommandHandler.java</title><link rel="stylesheet" href="../../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../../index.html" class="el_report">src (May 26, 2021 9:58:16 PM)</a> &gt; <a href="../../index.html" class="el_group">IslandTraderGUI</a> &gt; <a href="../index.html" class="el_bundle">src</a> &gt; <a href="index.source.html" class="el_package">commands</a> &gt; <span class="el_source">CommandHandler.java</span></div><h1>CommandHandler.java</h1><pre class="source lang-java linenums">package commands;

import java.util.ArrayList;
import trader.*;
import ships.*;
import map.*;

/**
 * The CommandHandler is created for the playing part of command line interface.
 * It gets an ArrayList of commands in string form from the IO object, invokes
 * matching methods from Trader and Ship objects, and returns a report in string
 * for the ReportPrinter object.
 * &lt;p&gt;
 * The CommandHandler is a command processor getting user's inputs from IO
 * objects of io package and processes the inputs by calling matching methods
 * from other objects.
 * &lt;p&gt;
 * 
 * @author Finn van Dorsser
 * @author Meng Zhang
 */

public class CommandHandler {
	
	/**
	 * Attribute map is a World object which stores all the environment objects 
	 * like Islands, Stores, Ports, Routes and Items. It is used to get 
	 * arguments for calling sailing method.
	 */ 
	private static World map;
	
	/**
	 * Attribute player is the current player object. It is used to call 
	 * trading methods, repair method, cannon upgrade method and viewing status 
	 * methods.
	 */ 
	private static Trader player;
	
	/**
	 * Attribute ship is the current player's ship object. It is used to call
	 * sailing method, trading methods and Ship status viewing methods.
	 */ 
	private static Ship ship;

	/**
	 * This constructor sets the values for all the attributes map, player and
	 * ship.
	 * @param map the current World object
	 * @param player the current Trader object
	 * @param ship the current Ship object
	 */
<span class="nc" id="L52">	public CommandHandler(World map, Trader player, Ship ship) {</span>
<span class="nc" id="L53">		CommandHandler.map = map;</span>
<span class="nc" id="L54">		CommandHandler.player = player;</span>
<span class="nc" id="L55">		CommandHandler.ship = ship;</span>
<span class="nc" id="L56">	}</span>

	/**
	 * This method takes an ArrayList of string commands, separates the command 
	 * name from its arguments and calls their matching methods.
	 * @param commandArguments An ArrayList including all the commands and 
	 * arguments in string form
	 * @return the string report of implementing the command in the argument
	 */
	public static String processCommand(ArrayList&lt;String&gt; commandArguments) {

<span class="nc" id="L67">		String report = &quot;&quot;;</span>
		// System.out.println(commandArguments);
<span class="nc" id="L69">		String keyWord = commandArguments.get(0);</span>
<span class="nc" id="L70">		String argument = commandArguments.get(1);</span>

<span class="nc bnc" id="L72" title="All 2 branches missed.">		if (!commandArguments.contains(&quot;cancel&quot;)) {</span>
<span class="nc" id="L73">			int quantity = 0;</span>
<span class="nc bnc" id="L74" title="All 2 branches missed.">			if (commandArguments.size() == 3) {</span>
<span class="nc" id="L75">				quantity = Integer.parseInt(commandArguments.get(2));</span>
			}

<span class="nc bnc" id="L78" title="All 10 branches missed.">			switch (keyWord) {</span>

			case &quot;sail&quot;:
<span class="nc" id="L81">				report = processSailCommand(argument);</span>
<span class="nc" id="L82">				break;</span>
			case &quot;buy&quot;:
<span class="nc" id="L84">				report = processBuyCommand(argument, quantity);</span>
<span class="nc" id="L85">				break;</span>
			case &quot;sell&quot;:
<span class="nc" id="L87">				report = processSellCommand(argument, quantity);</span>
<span class="nc" id="L88">				break;</span>
			case &quot;logs&quot;:
<span class="nc" id="L90">				report = processViewLogsCommand();</span>
<span class="nc" id="L91">				break;</span>
			case &quot;ship&quot;:
<span class="nc" id="L93">				report = processViewShipCommand();</span>
<span class="nc" id="L94">				break;</span>
			case &quot;store&quot;:
<span class="nc" id="L96">				report = processVisitStoreCommand();</span>
<span class="nc" id="L97">				break;</span>
			case &quot;repair&quot;:
<span class="nc" id="L99">				report = processRepairCommand();</span>
<span class="nc" id="L100">				break;</span>
			case &quot;upgrade&quot;:
<span class="nc" id="L102">				report = processUpgradeCommand(Integer.parseInt(argument));</span>
<span class="nc" id="L103">				break;</span>
			case &quot;quit&quot;:
<span class="nc" id="L105">				report = processQuitCommand();</span>
				break;
			}
<span class="nc bnc" id="L108" title="All 2 branches missed.">		} else if (player.getCurrentLocation() == &quot;store&quot;) {</span>
<span class="nc" id="L109">			report = &quot;Cancelling...\nBack at storefront!&quot;;</span>
<span class="nc" id="L110">		} else {</span>
<span class="nc" id="L111">			report = String.format(&quot;Back at %s!&quot;, player.getCurrentLocation());</span>
		}

<span class="nc" id="L114">		return report;</span>
	}
	
	/**
	 * This method calls the sailing method of the ship object, iterate the
	 * string reports in the ArrayList returned by the sailing method and
	 * combine them into a single string. 
	 * @param destination a string name of the destination island name
	 * @return a string report of the random events which happen during this 
	 * sailing
	 */
	public static String processSailCommand(String destination) {
<span class="nc" id="L126">		Island island = map.getIsland(destination);</span>
<span class="nc" id="L127">		ArrayList&lt;String&gt; reportList = ship.sailTo(island);</span>
<span class="nc" id="L128">		String report = &quot;Sailing ~~~ ~~~ ~~~\n\n&quot;;</span>

<span class="nc bnc" id="L130" title="All 2 branches missed.">		for (String event : reportList) {</span>
<span class="nc" id="L131">			report += event;</span>
		}

<span class="nc" id="L134">		return report;</span>
	}

	/**
	 * This method calls the buying method of the Trader object.
	 * @param itemName the string name of the item on sale
	 * @param quantity the integer number of the item quantity
	 * @return the string report of the result of this purchase
	 */
	public static String processBuyCommand(String itemName, int quantity) {
<span class="nc" id="L144">		Island currentIsland = player.getCurrentIsland();</span>
<span class="nc" id="L145">		String report = player.buy(currentIsland, itemName, quantity);</span>
<span class="nc" id="L146">		return report;</span>
	}

	/**
	 * This method calls the selling method of the Trader object.
	 * @param itemName the string name of the item to sell
 	 * @param quantity the integer number of the item quantity
	 * @return the string report of the result of this selling 
	 */
	public static String processSellCommand(String itemName, int quantity) {
<span class="nc" id="L156">		Island currentIsland = player.getCurrentIsland();</span>
<span class="nc" id="L157">		String report = player.sell(currentIsland, itemName, quantity);</span>
<span class="nc" id="L158">		return report;</span>
	}

	/**
	 * This method calls the Trading log getter of the Trader object.
	 * @return the string report including all the trading logs
	 */
	public static String processViewLogsCommand() {
<span class="nc" id="L166">		return player.getTradingLogsString();</span>
	}

	/**
	 * This method calls the status getter, cargos getter and upgrade log getter 
	 * of the Ship object, and combine them together to form a single report.
	 * @return the string report including the ship's basic properties, cargo 
	 * status and upgrade logs
	 */
	public static String processViewShipCommand() {
<span class="nc" id="L176">		Ship playerShip = player.getOwndedShip();</span>
<span class="nc" id="L177">		String report = playerShip.toString() + &quot;\n\n&quot; + </span>
<span class="nc" id="L178">		                playerShip.getCargosString() + &quot;\n&quot; + </span>
<span class="nc" id="L179">				        playerShip.getUpgradeLogString();</span>
<span class="nc" id="L180">		return report;</span>
	}

	/**
	 * This method calls the for-sale getter and for-purchase getter from the 
	 * store object on the trader's located island and combine them as a single
	 * report.
	 * @return the string report including this store's items for sale list and 
	 * items to buy list.
	 */
	public static String processVisitStoreCommand() {
<span class="nc" id="L191">		player.setCurrentLocation(&quot;store&quot;);</span>
<span class="nc" id="L192">		String report = &quot;Welcome to the store!\n\n&quot;;</span>
<span class="nc" id="L193">		report += player.getCurrentIsland().getStore().forSale() + &quot;\n&quot;;</span>
<span class="nc" id="L194">		report += player.getCurrentIsland().getStore().forPurchase();</span>
<span class="nc" id="L195">		return report;</span>
	}

	/**
	 * This method calls the repairShip method of the Trader object.
	 * @return the string report of the repair command
	 */
	public static String processRepairCommand() {
<span class="nc" id="L203">		String report = player.repairShip();</span>
<span class="nc" id="L204">		return report;</span>
	}

	/**
	 * This method takes an integer of the cannon number and calls the 
	 * upgradeCannons method of the Trader object.
	 * @param cannonNum the integer number of the cannons to be upgraded
	 * @return the string report of this cannon upgrade
	 */
	public static String processUpgradeCommand(int cannonNum) {
<span class="nc" id="L214">		String report = player.upgradeCannons(cannonNum);</span>
<span class="nc" id="L215">		return report;</span>
	}

	/**
	 * This method calls the link hasQuit setter of the Trader object and 
	 * sets hasQuit to true.
	 * @return a string report saying &quot;Goodbye!&quot;
	 */
	public static String processQuitCommand() {
<span class="nc" id="L224">		String report = &quot;Goodbye!&quot;;</span>
<span class="nc" id="L225">		player.setHasQuit(true);</span>
<span class="nc" id="L226">		return report;</span>
	}

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span>src (May 26, 2021 9:58:16 PM)</div></body></html>