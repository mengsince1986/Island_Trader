<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../../jacoco-resources/report.gif" type="image/gif"/><title>Trader.java</title><link rel="stylesheet" href="../../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../../index.html" class="el_report">src (May 26, 2021 9:58:16 PM)</a> &gt; <a href="../../index.html" class="el_group">IslandTraderGUI</a> &gt; <a href="../index.html" class="el_bundle">src</a> &gt; <a href="index.source.html" class="el_package">trader</a> &gt; <span class="el_source">Trader.java</span></div><h1>Trader.java</h1><pre class="source lang-java linenums">package trader;
import java.util.*;
import ships.*;
import map.*;
import items.*;
import events.*;

/**
 * A class to represent the current player of the game. Key behaviours include
 * buying and selling {@link Item}s, upgrading the cannons on the player's {@link Ship},
 * repairing the Ship.
 * 
 * @author Finn van Dorsser
 * @author Meng Zhang
 */
public class Trader {
	
	/**
	 * the number of days the player chose to play for.
	 */
	private int selectedDays;
	
	/**
	 * the number of days the player has still to play.
	 */
	private int remainingDays;
	
	/**
	 * the name String of the player, chosen at the beginning of the game.
	 */
	private String name;
	
	/**
	 * the default amount of money a player starts the game with.
	 */
	private int startingMoney;
	
	/**
	 * the amount of money a player currently has.
	 */
	private int ownedMoney;
	
	/**
	 * the {@link Island} which the player starts the game at.
	 */
	private Island homeIsland;
	
	/**
	 * the player's {@link Ship}, used to store cargo for trading and for 
	 * sailing between Islands.
	 */
	private Ship ownedShip;
	
	/**
	 * the {@link Island} where the player is currently located.
	 */
	private Island currentIsland;
	
	/**
	 * a String representation of which object, an Island's {@link Port} or {@link Store},
	 * the player can currently interact with.
	 * Can take the values &quot;port&quot; or &quot;store&quot;.
	 */
	private String currentLocation;
	
	/**
	 * stores a {@link TradingLog} for each transaction that the player has made.
	 */
	private ArrayList&lt;TradingLog&gt; tradingLogs;
	
	/**
	 * stores a boolean value signifying whether the player has been forced to
	 * walk the plank by pirates (initialised to false). 
	 * If true, the game will be over.
	 */
<span class="fc" id="L76">	private boolean killedByPirates = false;</span>
	
	/**
	 * stores a boolean value signifying whether the player has chosen to quit
	 * the game (initialised to false). 
	 * If true, the game will be over.
	 */
<span class="fc" id="L83">	private boolean hasQuit = false;</span>
	
	/**
	 * provides customisation of the initial values of all starting attributes.
	 * Convenient for testing.
	 * @param days the selected number of days to play
	 * @param name the selected name of the player
	 * @param money the player's starting money
	 * @param home the player's starting Island
	 * @param currentLocation &quot;port&quot; or &quot;store&quot;
	 */
<span class="fc" id="L94">	public Trader(int days, String name, int money,</span>
			      Island home, String currentLocation) {
<span class="fc" id="L96">		this.selectedDays = days;</span>
<span class="fc" id="L97">		this.remainingDays = days;</span>
<span class="fc" id="L98">		this.name = name;</span>
<span class="fc" id="L99">		this.startingMoney = money;</span>
<span class="fc" id="L100">		this.ownedMoney = money;</span>
<span class="fc" id="L101">		this.homeIsland = home;</span>
<span class="fc" id="L102">		this.currentIsland = home;</span>
<span class="fc" id="L103">		this.currentLocation = currentLocation;</span>
<span class="fc" id="L104">		this.tradingLogs = new ArrayList&lt;TradingLog&gt;();	</span>
<span class="fc" id="L105">	}</span>
	
	/**
	 * allows customisation of only those attributes that the player can choose 
	 * themselves.
	 * @param days the selected number of days to play
	 * @param name the selected name String of the player
	 * @param home the player's starting Island
	 */
<span class="fc" id="L114">	public Trader(int days, String name, Island home) {</span>
<span class="fc" id="L115">		this.selectedDays = days;</span>
<span class="fc" id="L116">		this.remainingDays = days;</span>
<span class="fc" id="L117">		this.selectedDays = days;</span>
<span class="fc" id="L118">		this.name = name;</span>
<span class="fc" id="L119">		this.ownedMoney = 10000;</span>
<span class="fc" id="L120">		this.startingMoney = 15000;</span>
<span class="fc" id="L121">		this.ownedMoney = 15000;</span>
<span class="fc" id="L122">		this.homeIsland = home;</span>
<span class="fc" id="L123">		this.currentIsland = home;</span>
<span class="fc" id="L124">		this.currentLocation = &quot;port&quot;;</span>
<span class="fc" id="L125">		this.tradingLogs = new ArrayList&lt;TradingLog&gt;();	</span>
<span class="fc" id="L126">}</span>
	
	// getters
	/**
	 * @return the player's {@link selectedDays}.
	 */
	public int getSelectedDays() {
<span class="nc" id="L133">		return this.selectedDays;</span>
	}
	
	/**
	 * @return the player's {@link remainingDays}.
	 */
	public int getRemainingDays() {
<span class="fc" id="L140">		return this.remainingDays;</span>
	}
	
	/**
	 * @return the player's {@link name}.
	 */
	public String getName() {
<span class="nc" id="L147">		return this.name;</span>
	}
	
	/**
	 * @return the player's {@link startingMoney}.
	 */
	public int getStartingMoney() {
<span class="fc" id="L154">		return this.startingMoney;</span>
	}
	
	/**
	 * @return the player's {@link ownedMoney}.
	 */
	public int getOwnedMoney() {
<span class="fc" id="L161">		return this.ownedMoney;</span>
	}
	
	/**
	 * @return the player's {@link homeIsland}.
	 */
	public Island getHomeIsland() {
<span class="nc" id="L168">		return this.homeIsland;</span>
	}
	
	/**
	 * @return the player's {@link ownedShip}.
	 */
	public Ship getOwndedShip() {
<span class="fc" id="L175">		return this.ownedShip;</span>
	}
	
	/**
	 * @return the player's {@link currentIsland}.
	 */
	public Island getCurrentIsland() {
<span class="fc" id="L182">		return this.currentIsland;</span>
	}
	
	/**
	 * @return the player's {@link currentLocation}.
	 */
	public String getCurrentLocation() {
<span class="fc" id="L189">		return this.currentLocation;</span>
	}
	
	/**
	 * @return the player's {@link tradingLogs}.
	 */
	public ArrayList&lt;TradingLog&gt; getTradingLogs() {
<span class="fc" id="L196">		return this.tradingLogs;</span>
	}
	
	/**
	 * @return a pretty String representation of the player's {@link tradingLogs}.
	 */
	public String getTradingLogsString() {
<span class="nc" id="L203">		String logsString = &quot;Your trading log:\n\n&quot;;</span>
<span class="nc bnc" id="L204" title="All 2 branches missed.">		if (this.tradingLogs.size() &gt; 0) {</span>
<span class="nc bnc" id="L205" title="All 2 branches missed.">			for (TradingLog log : this.tradingLogs) {</span>
<span class="nc" id="L206">				logsString += log.toString() + &quot;\n&quot;;</span>
			}
<span class="nc" id="L208">		} else {</span>
<span class="nc" id="L209">			logsString += &quot;You haven't bought or sold anything yet!&quot;;</span>
		}
<span class="nc" id="L211">		return logsString;</span>
	}
	
	/**
	 * @return the boolean {@link killedByPirates} attribute value
	 */
	public boolean getKilledByPirates() {
<span class="nc" id="L218">		return this.killedByPirates;</span>
	}
	
	/**
	 * @return the boolean {@link hasQuit} attribute value
	 */
	public boolean getHasQuit() {
<span class="nc" id="L225">		return this.hasQuit;</span>
	}
	
	// setters
	/**
	 * sets a new value for the player's {@link remainingDays}.
	 * @param days the new number of remaining days
	 */
	public void setRemainingDays(int days) {
<span class="fc" id="L234">		this.remainingDays = days;</span>
<span class="fc" id="L235">	}</span>
	
	/**
	 * updates the player's {@link remainingDays}.
	 * @param days the number of days to subtract
	 */
	public void subtractRemainingDays(int days) {
<span class="fc" id="L242">		this.remainingDays -= days;</span>
<span class="fc" id="L243">	}</span>
	
	/**
	 * sets the player's {@link name}.
	 * @param name the new name String
	 */
	public void setName (String name) {
<span class="nc" id="L250">		this.name = name;</span>
<span class="nc" id="L251">	}</span>
	
	/**
	 * sets a new value for the player's {@link ownedMoney}.
	 * @param amount the new amount of money
	 */
	public void setOwnedMoney(int amount) {
<span class="fc" id="L258">		this.ownedMoney = amount;</span>
<span class="fc" id="L259">	}</span>
	
	/**
	 * updates the player's {@link ownedMoney}.
	 * @param amount the amount to add
	 */
	public void addMoney(int amount) {
<span class="fc" id="L266">		this.ownedMoney += amount;</span>
<span class="fc" id="L267">	}</span>
	
	/**
	 * updates the player's {@link ownedMoney}.
	 * @param amount the amount to deduct
	 */
	public void subtractMoney(int amount) {
<span class="fc" id="L274">		this.ownedMoney -= amount;</span>
<span class="fc" id="L275">	}</span>
	
	/**
	 * sets the player's {@link homeIsland}.
	 * @param island the new starting Island
	 */
	public void setHomeIsland(Island island) {
<span class="nc" id="L282">		this.homeIsland = island;</span>
<span class="nc" id="L283">	}</span>
	
	/**
	 * sets the player's {@link ownedShip}.
	 * @param ship the new Ship
	 */
	public void setOwnedShip(Ship ship) {
<span class="fc" id="L290">		this.ownedShip = ship;</span>
<span class="fc" id="L291">	}</span>
	
	/**
	 * sets the player's {@link currentIsland}.
	 * @param island the new current Island
	 */
	public void setCurrentIsland(Island island) {
<span class="fc" id="L298">		this.currentIsland = island;</span>
<span class="fc" id="L299">	}</span>
	
	/**
	 * sets the player's {@link currentLocation}.
	 * @param location &quot;port&quot; or &quot;store&quot;, to designate the player's {@link currentLocation}
	 */
	public void setCurrentLocation(String location) {
<span class="fc" id="L306">		this.currentLocation = location;</span>
<span class="fc" id="L307">	}</span>
	
	/**
	 * sets the player's {@link killedByPirates} attribute to the given value.
	 * (Used to signify whether the player was forced to walk the plank by pirates.)
	 * @param value a boolean value
	 */
	public void setKilledByPirates(boolean value) {
<span class="nc" id="L315">		this.killedByPirates = value;</span>
<span class="nc" id="L316">	}</span>
	
	/**
	 * sets the player's {@link hasQuit} attribute to the given value.
	 * (Used to signify whether the player has chosen to quit the game.)
	 * @param value a boolean value
	 */
	public void setHasQuit(boolean value) {
<span class="nc" id="L324">		this.hasQuit = value;</span>
<span class="nc" id="L325">	}</span>
	
	/**
	 * adds a {@link TradingLog} to the player's {@link tradingLogs}
	 * @param tradingIsland the Island where the transaction occurred
	 * @param item the Item traded
	 * @param sellOrBuy &quot;Bought&quot; or &quot;Sold&quot;
	 */
	public void addTradingLog(Island tradingIsland, 
			                  Item item, String sellOrBuy) {
<span class="fc" id="L335">		TradingLog log = new TradingLog(tradingIsland, item, sellOrBuy);</span>
<span class="fc" id="L336">		this.tradingLogs.add(log);</span>
<span class="fc" id="L337">	}</span>
	
	/**
	 * allows the player to try to sell an {@link Item} to the {@link Store} on the 
	 * current {@link Island}. Checks that the Store is willing to buy the given 
	 * quantity of the Item to be sold, and that the player owns that quantity, before 
	 * processing the transaction. Returns a report String detailing the outcome of the 
	 * attempted transaction to be displayed to the player.
	 * @param currentIsland the player's current Island
	 * @param itemName the name of the Item to be sold
	 * @param quantity the quantity of the Item to be sold
	 * @return a String detailing the outcome of the attempted sale
	 */
	public String sell(Island currentIsland, String itemName, int quantity) { 
<span class="fc" id="L351">		String report = &quot;&quot;;</span>
<span class="fc" id="L352">		Store currentStore = currentIsland.getStore();</span>
<span class="fc" id="L353">		Ship playerShip = getOwndedShip();</span>
<span class="fc" id="L354">		Item itemToSell = playerShip.getCargoItem(itemName);</span>
<span class="fc" id="L355">		int pricePerUnit = currentStore.checkItemPrice(itemName, &quot;toBuy&quot;);</span>
		
<span class="fc bfc" id="L357" title="All 2 branches covered.">		if (currentStore.getItem(itemName, &quot;toBuy&quot;).getQuantity() &lt; quantity) {</span>
<span class="fc" id="L358">			report = &quot;The store won't buy that many! Try again.\n&quot; +</span>
					&quot;Redirecting you to storefront...&quot;;
		
<span class="fc bfc" id="L361" title="All 2 branches covered.">		} else if (itemToSell.getQuantity() &lt; quantity) {</span>
<span class="fc" id="L362">			report = &quot;You don't own that quantity of the item! Try again.\n&quot; +</span>
					&quot;Redirecting you to storefront...&quot;;
			
<span class="fc" id="L365">		} else {</span>
			
				//update store
<span class="fc" id="L368">				Item itemSold = currentStore.boughtItem(itemName, quantity);</span>
				
				//update cargo
<span class="fc" id="L371">				getOwndedShip().subtractFromCargos(itemToSell, quantity);</span>
				
				//update money
<span class="fc" id="L374">				int priceReceived = quantity * pricePerUnit;</span>
<span class="fc" id="L375">				addMoney(priceReceived);</span>
				
				//update trading log
<span class="fc" id="L378">				this.addTradingLog(currentIsland, itemSold, &quot;Sold&quot;);</span>
				
<span class="fc" id="L380">				report = &quot;Success!\n&quot; +</span>
						&quot;Return to port to view your trading logs\n&quot; +
						&quot;Most recent: &quot; +
<span class="fc" id="L383">						this.getTradingLogs().get(this.getTradingLogs().size() - 1).toString() +</span>
<span class="fc" id="L384">						&quot;\nRedirecting you to storefront...&quot;;</span>
		} 
<span class="fc" id="L386">		return report;</span>
	}
	

	/**
	 * allows the player to try to buy an {@link Item} from the {@link Store} on the 
	 * current {@link Island}. Checks that the Store has the given 
	 * quantity of the Item in stock, that the player has enough money to purchase
	 * that many, and that the player's {@link Ship} has enough remaining capacity to 
	 * hold the Item before processing the transaction. 
	 * Returns a report String detailing the outcome of the attempted transaction to be 
	 * displayed to the player.
	 * @param currentIsland the player's current Island
	 * @param itemName the name of the Item to be bought
	 * @param quantity the quantity of the Item to be bought
	 * @return a String detailing the outcome of the attempted purchase
	 */
	public String buy(Island currentIsland, String itemName, int quantity) {
<span class="fc" id="L404">		String report = &quot;&quot;;</span>
<span class="fc" id="L405">		Store currentStore = currentIsland.getStore();</span>
<span class="fc" id="L406">		Item itemToBuy = currentStore.getItem(itemName, &quot;toSell&quot;);</span>
<span class="fc bfc" id="L407" title="All 2 branches covered.">		if (getOwnedMoney() &lt; (itemToBuy.getPricePerUnit() * quantity)) {</span>
<span class="fc" id="L408">			report = &quot;You don't have enough funds to make that purchase!\n&quot; +</span>
					&quot;Redirecting you to storefront...&quot;;
<span class="fc bfc" id="L410" title="All 2 branches covered.">		} else if (quantity &gt; itemToBuy.getQuantity()) {</span>
<span class="fc" id="L411">			report = &quot;The store can't sell you that many!\n&quot; +</span>
					&quot;Redirecting you to storefront...&quot;;
<span class="fc bfc" id="L413" title="All 2 branches covered.">		} else if (!getOwndedShip().checkCapacityOK(quantity)) {</span>
<span class="fc" id="L414">			report = &quot;Your ship doesn't have enough remaining cargo capacity!\n&quot; +</span>
					&quot;Redirecting you to storefront...&quot;;
<span class="fc" id="L416">		} else {</span>
			//update cargo
<span class="fc" id="L418">			Item itemBought = currentStore.soldItem(itemName, quantity);</span>
<span class="fc" id="L419">			getOwndedShip().addToCargos(itemBought, quantity);</span>
			
			//update money
<span class="fc" id="L422">			int priceToPay = itemBought.getPricePerUnit() * quantity;</span>
<span class="fc" id="L423">			subtractMoney(priceToPay);</span>
			
			//update trading log
<span class="fc" id="L426">			addTradingLog(currentIsland, itemBought, &quot;Bought&quot;);</span>
			
<span class="fc" id="L428">			report = &quot;Success!\n&quot; +</span>
					&quot;Return to port to view your trading logs\n&quot; +
					&quot;Most recent: &quot; +
<span class="fc" id="L431">					this.getTradingLogs().get(this.getTradingLogs().size() - 1).toString() +</span>
<span class="fc" id="L432">					&quot;\nRedirecting you to storefront...&quot;;</span>
		}
<span class="fc" id="L434">		return report;</span>
	}
	
	/**
	 * allows the player to try to repair their {@link Ship} of the damage sustained as a result
	 * of a {@link WeatherEvent}. Checks that there is damage to be repaired, and that the player 
	 * has enough money to complete the repair, before processing the transaction.
	 * Returns a report String detailing the outcome of the attempted transaction to be displayed 
	 * to the player.
	 * @return a String detailing the outcome of the attempted repair
	 */
	public String repairShip() {
		
<span class="fc" id="L447">		String report = &quot;You have to repair your ship at port&quot;;</span>
		
<span class="pc bpc" id="L449" title="1 of 2 branches missed.">		if (getCurrentLocation() == &quot;port&quot;) {</span>
			
<span class="fc" id="L451">			int repairCostPerDamage = getCurrentIsland().getPort().getRepairCost();</span>
<span class="fc" id="L452">			int currentDamage = getOwndedShip().getDamage();</span>
<span class="fc" id="L453">			int repairCost = currentDamage * repairCostPerDamage; </span>
<span class="fc bfc" id="L454" title="All 2 branches covered.">			if (this.getOwndedShip().getDamage() == 0) {</span>
<span class="fc" id="L455">				report = &quot;Your ship is fine. There's nothing to repair.&quot;;</span>
<span class="fc bfc" id="L456" title="All 2 branches covered.">			} else if (repairCost &lt;= getOwnedMoney()) {</span>
				// subtract repair cost from trader's owned money
<span class="fc" id="L458">				getOwndedShip().setDurability(getOwndedShip().getDefaultDurability());</span>
<span class="fc" id="L459">				subtractMoney(repairCost);</span>
				// log the repair service into upgradelog
<span class="fc" id="L461">				getOwndedShip().addToUpgradeLogs(currentIsland, &quot;Damage Repair&quot;, repairCost);</span>
<span class="fc" id="L462">				report = &quot;The damage has been fixed!\nYour ship is ready to sail again!&quot;;</span>
<span class="fc" id="L463">			} else {</span>
<span class="fc" id="L464">				report = &quot;Oh no! You don't have enough money for the repair!\n&quot; + </span>
						&quot;You'll need to sell some items!&quot;;
			}
		}
		
<span class="fc" id="L469">		return report;</span>
	}
	
	/**
	 * allows the player to try to increase the number of cannons on their {@link Ship}, for better
	 * chances of survival in a {@link PirateEvent}. Checks that the Ship has enough space
	 * to equip the given number of cannons, and that the player has enough money to complete the 
	 * upgrade, before processing the transaction.
	 * Returns a report String detailing the outcome of the attempted transaction to be displayed 
	 * to the player.
	 * @param cannonNum the number of cannons to install
	 * @return a String detailing the outcome of the attempted upgrade
	 */
	public String upgradeCannons(int cannonNum) {
		
<span class="fc" id="L484">		String report = &quot;You have to upgrade cannons at port&quot;;</span>
<span class="fc" id="L485">		int currentCannons = this.getOwndedShip().getCannons();</span>
<span class="fc" id="L486">		int maxCannons = this.getOwndedShip().getMaxCannons();</span>
		
<span class="pc bpc" id="L488" title="1 of 2 branches missed.">		if (getCurrentLocation() == &quot;port&quot;) {</span>
<span class="fc" id="L489">			int costPerCannon = getCurrentIsland().getPort().getcannonCost();</span>
<span class="fc" id="L490">			int totalCost = costPerCannon * cannonNum;</span>
<span class="fc bfc" id="L491" title="All 2 branches covered.">			if (currentCannons &gt;= maxCannons) {</span>
<span class="fc" id="L492">				report = &quot;You've got enough cannons on your ship. No space for any more!&quot;;</span>
<span class="fc bfc" id="L493" title="All 2 branches covered.">			} else if (currentCannons + cannonNum &gt; maxCannons) {</span>
<span class="fc" id="L494">				report = &quot;Captain, you can't equip so many cannons on your ship!\n&quot; +</span>
<span class="fc" id="L495">						 &quot;You can add at most &quot; + (maxCannons - currentCannons) +</span>
<span class="fc" id="L496">						 &quot; more.&quot;;</span>
<span class="fc bfc" id="L497" title="All 2 branches covered.">			} else if (totalCost &lt;= getOwnedMoney()) {</span>
				// subtract cannon upgrade cost from trader's owned money
<span class="fc" id="L499">				getOwndedShip().addCannons(cannonNum);</span>
<span class="fc" id="L500">				subtractMoney(totalCost);</span>
				// log the upgrade service into upgradeLog
<span class="fc" id="L502">				getOwndedShip().addToUpgradeLogs(currentIsland, &quot;Cannon Upgrade&quot;, totalCost);</span>
<span class="fc" id="L503">				report = &quot;You now have &quot; + cannonNum + &quot; more cannons equipped on your ship.&quot;;</span>
<span class="fc" id="L504">			} else {</span>
<span class="fc" id="L505">				report = &quot;Sorry, you don't have enough money to complete this upgrade.&quot;;</span>
			}
		}	
		
<span class="fc" id="L509">		return report;</span>
	}
	
	/**
	 * checks whether the player has enough {@link remainingDays} left to sail to another 
	 * {@link Island}. If not, the game will be over.
	 * @return a boolean signifying whether or not the game should be over.
	 */
	public boolean noTimeToSail() {
<span class="fc" id="L518">		boolean gameOver = true;</span>
<span class="fc bfc" id="L519" title="All 2 branches covered.">		for (Route route: this.currentIsland.getRoutes()) {</span>
<span class="pc bpc" id="L520" title="1 of 2 branches missed.">			if (this.remainingDays &gt; route.getSailingTime(this.ownedShip)) {</span>
<span class="nc" id="L521">				gameOver = false;</span>
			}
		}
<span class="fc" id="L524">		return gameOver;</span>
	}
	
	/**
	 * checks whether the player has enough {@link ownedMoney}, including the total value
	 * of the player's saleable Item objects, to be able to sail to another {@link Island}. 
	 * If not, the game will be over.
	 * @return a boolean signifying whether or not the game should be over.
	 */
	public boolean noMoneyToSail() {
<span class="fc" id="L534">		boolean gameOver = true;</span>
<span class="fc" id="L535">		int sellableCargoValue = getSellableCargoValue();</span>
<span class="fc bfc" id="L536" title="All 2 branches covered.">		for (Route route: this.currentIsland.getRoutes()) {</span>
<span class="fc" id="L537">			int sailingCost = route.getSailingTime(this.ownedShip) * this.ownedShip.getCostPerDay();</span>
<span class="fc bfc" id="L538" title="All 2 branches covered.">			if (sailingCost &lt;= (this.ownedMoney + sellableCargoValue)) {</span>
<span class="fc" id="L539">				gameOver = false;</span>
			}
		}
<span class="fc" id="L542">		Ship playerShip = this.ownedShip;</span>
<span class="fc" id="L543">		Port currentPort = this.getCurrentIsland().getPort();</span>
<span class="fc" id="L544">		int repairCost = playerShip.getDamage() * currentPort.getRepairCost();</span>
<span class="pc bpc" id="L545" title="1 of 2 branches missed.">		if (repairCost &gt; (this.ownedMoney + sellableCargoValue)) {</span>
<span class="nc" id="L546">			gameOver = true;</span>
		}
<span class="fc" id="L548">		return gameOver;</span>
	}
	
	/**
	 * @return the total sale value of the player's owned Item objects at the player's
	 * current Store.
	 */
	public int getSellableCargoValue() {
<span class="fc" id="L556">		Ship playerShip = this.getOwndedShip();</span>
<span class="fc" id="L557">		Island currentIsland = this.getCurrentIsland();</span>
<span class="fc" id="L558">		Store currentStore = currentIsland.getStore();</span>
<span class="fc" id="L559">		int sellableCargoValue = 0;</span>
<span class="fc bfc" id="L560" title="All 2 branches covered.">		for (Item sellableItem: currentStore.getSellablePlayerItems(playerShip)) {</span>
<span class="fc" id="L561">			int salePrice = sellableItem.getPricePerUnit();</span>
<span class="fc" id="L562">			int quantity = sellableItem.getQuantity();</span>
<span class="fc" id="L563">			sellableCargoValue += (salePrice * quantity);</span>
		}
<span class="fc" id="L565">		return sellableCargoValue;</span>
	}
			
	/**
	* @return a readable String representation of the player.
	*/
	public String toString() {
<span class="nc" id="L572">		String status = &quot;Name: &quot; + this.name + &quot;\n\n&quot; +</span>
<span class="nc" id="L573">						&quot;Money: &quot; + this.ownedMoney + &quot;\n\n&quot; +</span>
<span class="nc" id="L574">						&quot;Ship: &quot; + this.ownedShip.getName() + &quot;\n\n&quot; +</span>
<span class="nc" id="L575">						&quot;Current island: &quot; + this.currentIsland.getName() + &quot;\n&quot; +</span>
<span class="nc" id="L576">						&quot;Current location on the island: &quot; + this.currentLocation;</span>
<span class="nc" id="L577">		return status;</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span>src (May 26, 2021 9:58:16 PM)</div></body></html>